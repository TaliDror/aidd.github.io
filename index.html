<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Token-Based Audio Inpainting via Discrete Diffusion</title>

  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #ffffff;
      color: #111;
      line-height: 1.6;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 40px 20px 80px;
    }

    h1 {
      text-align: center;
      font-size: 2.4em;
      margin-bottom: 0.4em;
    }

    h2 {
      margin-top: 2.2em;
      border-bottom: 1px solid #eaeaea;
      padding-bottom: 0.3em;
    }

    .authors {
      text-align: center;
      font-size: 1.05em;
      margin-bottom: 0.3em;
    }

    .affiliations {
      text-align: center;
      color: #555;
      font-size: 0.95em;
      margin-bottom: 1em;
    }

    .links {
      text-align: center;
      margin: 1.2em 0 2em;
    }

    .links a {
      margin: 0 10px;
      padding: 8px 14px;
      border: 1px solid #ddd;
      border-radius: 6px;
      text-decoration: none;
      color: #111;
      font-size: 0.95em;
    }

    .links a:hover {
      background: #f5f5f5;
    }

    .figure {
      text-align: center;
      margin: 2.5em 0;
    }

    .figure img {
      max-width: 100%;
      border-radius: 6px;
    }

    .caption {
      font-size: 0.9em;
      color: #555;
      margin-top: 0.6em;
    }

    .abstract {
      background: #fafafa;
      border: 1px solid #eaeaea;
      border-radius: 8px;
      padding: 20px;
    }

    pre {
      background: #f6f8fa;
      padding: 15px;
      border-radius: 6px;
      overflow-x: auto;
      font-size: 0.9em;
    }

    footer {
      margin-top: 4em;
      text-align: center;
      color: #777;
      font-size: 0.85em;
    }
  </style>
</head>

<body>
  <div class="container">

    <h1>Token-Based Audio Inpainting via Discrete Diffusion</h1>

    <div class="authors">
      Tali Dror<sup>*</sup>, Iftach Shoham<sup>*</sup>, Moshe Buchris,
      Oren Gal, Haim Permuter, Gilad Katz, Eliya Nachmani
    </div>

    <div class="affiliations">
      Ben-Gurion University of the Negev Â· University of Haifa<br>
      <sup>*</sup>Equal contribution
    </div>

    <div class="links">
      <a href="https://arxiv.org/abs/2507.08333" target="_blank">ðŸ“„ Paper (arXiv)</a>
      <a href="https://github.com/iftachShoham/AIDD" target="_blank">ðŸ’» Code</a>
      <a href="https://huggingface.co/TaliDror/AIDD" target="_blank">ðŸ¤— Model Weights</a>
    </div>

    <div class="figure">
      <img src="method_figure.png" alt="AIDD overview">
      <div class="caption">
        Overview of AIDD. Audio is tokenized using WavTokenizer, inpainted via discrete diffusion,
        and decoded back to waveform audio.
      </div>
    </div>

    <h2>Abstract</h2>
    <div class="abstract">
      Audio inpainting seeks to restore missing segments in degraded recordings. Previous
      diffusion-based methods exhibit impaired performance when the missing region is large.
      We introduce the first approach that applies discrete diffusion over tokenized music
      representations, enabling stable and semantically coherent restoration of long gaps.
      Our method incorporates span-based masking and a derivative-based regularization loss,
      and achieves state-of-the-art performance on MusicNet and MAESTRO for gaps up to 750 ms.
    </div>

    <h2>Method</h2>
    <p>
      AIDD operates entirely in a discrete token space. Raw audio waveforms are first converted
      into compact sequences of discrete tokens using a pretrained <b>WavTokenizer</b>.
      A <b>Diffusion Transformer (DiT)</b> then performs inpainting by learning the reverse
      discrete diffusion process with an absorbing mask state.
    </p>
    <p>
      To better model structured missing regions, we introduce <b>span-based masking</b> during
      training. Additionally, a <b>derivative-based regularization loss</b> encourages smooth
      temporal dynamics in token embedding space, improving perceptual coherence of the
      reconstructed audio.
    </p>

<h2>Results</h2>
<p>
  AIDD achieves competitive or state-of-the-art results on MusicNet and MAESTRO across
  objective metrics (FAD, LSD, ODG) and subjective MOS evaluations, particularly for
  medium and long gaps (150â€“750 ms), while being more efficient than prior diffusion-based
  approaches.
</p>

<!-- ================= AUDIO EXAMPLES ================= -->

<h2 style="text-align:center; margin-top:3rem;">Audio Examples</h2>

<p style="text-align:center;">
Qualitative examples from MAESTRO with 375 ms and 750 ms gaps.
Each row shows Original, Masked, and AIDD Reconstruction.
</p>

<!-- ================= 375 ms ================= -->
<h3>Gap: 375 ms</h3>

<table style="width:100%; text-align:center; margin-bottom:3rem;">
<tr>
  <th>Original</th>
  <th>Masked</th>
  <th>AIDD</th>
</tr>

<tr>
<td><audio controls><source src="examples/375/original/MIDI-UNPROCESSED_01-03_R1_2014_MID--AUDIO_03_R1_2014_wav--4.wav" type="audio/wav"></audio></td>
<td><audio controls><source src="examples/375/masked/MIDI-UNPROCESSED_01-03_R1_2014_MID--AUDIO_03_R1_2014_wav--4.wav" type="audio/wav"></audio></td>
<td><audio controls><source src="examples/375/reconstructed/MIDI-UNPROCESSED_01-03_R1_2014_MID--AUDIO_03_R1_2014_wav--4_gen0.wav" type="audio/wav"></audio></td>
</tr>

<tr>
<td><audio controls><source src="examples/375/original/MIDI-Unprocessed_02_R1_2009_03-06_ORIG_MID--AUDIO_02_R1_2009_02_R1_2009_03_WAV.wav" type="audio/wav"></audio></td>
<td><audio controls><source src="examples/375/masked/MIDI-Unprocessed_02_R1_2009_03-06_ORIG_MID--AUDIO_02_R1_2009_02_R1_2009_03_WAV.wav" type="audio/wav"></audio></td>
<td><audio controls><source src="examples/375/reconstructed/MIDI-Unprocessed_02_R1_2009_03-06_ORIG_MID--AUDIO_02_R1_2009_02_R1_2009_03_WAV_gen0.wav" type="audio/wav"></audio></td>
</tr>

<tr>
<td><audio controls><source src="examples/375/original/MIDI-Unprocessed_049_PIANO049_MID--AUDIO-split_07-06-17_Piano-e_2-06_wav--2.wav" type="audio/wav"></audio></td>
<td><audio controls><source src="examples/375/masked/MIDI-Unprocessed_049_PIANO049_MID--AUDIO-split_07-06-17_Piano-e_2-06_wav--2.wav" type="audio/wav"></audio></td>
<td><audio controls><source src="examples/375/reconstructed/MIDI-Unprocessed_049_PIANO049_MID--AUDIO-split_07-06-17_Piano-e_2-06_wav--2_gen0.wav" type="audio/wav"></audio></td>
</tr>

<tr>
<td><audio controls><source src="examples/375/original/MIDI-Unprocessed_053_PIANO053_MID--AUDIO-split_07-06-17_Piano-e_3-04_wav--1.wav" type="audio/wav"></audio></td>
<td><audio controls><source src="examples/375/masked/MIDI-Unprocessed_053_PIANO053_MID--AUDIO-split_07-06-17_Piano-e_3-04_wav--1.wav" type="audio/wav"></audio></td>
<td><audio controls><source src="examples/375/reconstructed/MIDI-Unprocessed_053_PIANO053_MID--AUDIO-split_07-06-17_Piano-e_3-04_wav--1_gen0.wav" type="audio/wav"></audio></td>
</tr>

<tr>
<td><audio controls><source src="examples/375/original/MIDI-Unprocessed_075_PIANO075_MID--AUDIO-split_07-08-17_Piano-e_2-06_wav--3.wav" type="audio/wav"></audio></td>
<td><audio controls><source src="examples/375/masked/MIDI-Unprocessed_075_PIANO075_MID--AUDIO-split_07-08-17_Piano-e_2-06_wav--3.wav" type="audio/wav"></audio></td>
<td><audio controls><source src="examples/375/reconstructed/MIDI-Unprocessed_075_PIANO075_MID--AUDIO-split_07-08-17_Piano-e_2-06_wav--3_gen0.wav" type="audio/wav"></audio></td>
</tr>

</table>

<!-- ================= 750 ms ================= -->
<h3>Gap: 750 ms</h3>

<table style="width:100%; text-align:center; margin-bottom:3rem;">
<tr>
  <th>Original</th>
  <th>Masked</th>
  <th>AIDD</th>
</tr>

<tr>
<td><audio controls><source src="examples/750/original/MIDI-Unprocessed_05_R1_2008_01-04_ORIG_MID--AUDIO_05_R1_2008_wav--3.wav" type="audio/wav"></audio></td>
<td><audio controls><source src="examples/750/masked/MIDI-Unprocessed_05_R1_2008_01-04_ORIG_MID--AUDIO_05_R1_2008_wav--3.wav" type="audio/wav"></audio></td>
<td><audio controls><source src="examples/750/reconstructed/MIDI-Unprocessed_05_R1_2008_01-04_ORIG_MID--AUDIO_05_R1_2008_wav--3_gen0.wav" type="audio/wav"></audio></td>
</tr>

<tr>
<td><audio controls><source src="examples/750/original/MIDI-Unprocessed_06_R1_2008_01-04_ORIG_MID--AUDIO_06_R1_2008_wav--2.wav" type="audio/wav"></audio></td>
<td><audio controls><source src="examples/750/masked/MIDI-Unprocessed_06_R1_2008_01-04_ORIG_MID--AUDIO_06_R1_2008_wav--2.wav" type="audio/wav"></audio></td>
<td><audio controls><source src="examples/750/reconstructed/MIDI-Unprocessed_06_R1_2008_01-04_ORIG_MID--AUDIO_06_R1_2008_wav--2_gen0.wav" type="audio/wav"></audio></td>
</tr>

<tr>
<td><audio controls><source src="examples/750/original/MIDI-UNPROCESSED_09-10_R1_2014_MID--AUDIO_09_R1_2014_wav--4.wav" type="audio/wav"></audio></td>
<td><audio controls><source src="examples/750/masked/MIDI-UNPROCESSED_09-10_R1_2014_MID--AUDIO_09_R1_2014_wav--4.wav" type="audio/wav"></audio></td>
<td><audio controls><source src="examples/750/reconstructed/MIDI-UNPROCESSED_09-10_R1_2014_MID--AUDIO_09_R1_2014_wav--4_gen0.wav" type="audio/wav"></audio></td>
</tr>

<tr>
<td><audio controls><source src="examples/750/original/MIDI-Unprocessed_R2_D2-12-13-15_mid--AUDIO-from_mp3_13_R2_2015_wav--4.wav" type="audio/wav"></audio></td>
<td><audio controls><source src="examples/750/masked/MIDI-Unprocessed_R2_D2-12-13-15_mid--AUDIO-from_mp3_13_R2_2015_wav--4.wav" type="audio/wav"></audio></td>
<td><audio controls><source src="examples/750/reconstructed/MIDI-Unprocessed_R2_D2-12-13-15_mid--AUDIO-from_mp3_13_R2_2015_wav--4_gen0.wav" type="audio/wav"></audio></td>
</tr>

<tr>
<td><audio controls><source src="examples/750/original/ORIG-MIDI_03_7_8_13_Group__MID--AUDIO_19_R2_2013_wav--4.wav" type="audio/wav"></audio></td>
<td><audio controls><source src="examples/750/masked/ORIG-MIDI_03_7_8_13_Group__MID--AUDIO_19_R2_2013_wav--4.wav" type="audio/wav"></audio></td>
<td><audio controls><source src="examples/750/reconstructed/ORIG-MIDI_03_7_8_13_Group__MID--AUDIO_19_R2_2013_wav--4_gen0.wav" type="audio/wav"></audio></td>
</tr>

</table>


<h2>Citation</h2>

    <pre>
@article{dror2025token,
  title={Token-based Audio Inpainting via Discrete Diffusion},
  author={Dror, Tali and Shoham, Iftach and Buchris, Moshe and Gal, Oren and Permuter, Haim and Katz, Gilad and Nachmani, Eliya},
  journal={arXiv preprint arXiv:2507.08333},
  year={2025}
}
    </pre>

    <h2>Acknowledgments</h2>
    <p>
      This work is built upon prior works, including
      <i>Discrete Diffusion Modeling by Estimating the Ratios of the Data Distribution</i>
      and <i>WavTokenizer: An Efficient Acoustic Discrete Codec Tokenizer for Audio Language Modeling</i>.
      We are grateful to the authors for making their methods and code publicly available.
    </p>



  </div>
</body>
</html>
